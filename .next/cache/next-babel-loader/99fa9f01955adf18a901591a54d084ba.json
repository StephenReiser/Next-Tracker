{"ast":null,"code":"import { MongoClient } from 'mongodb';\nimport nextConnect from 'next-connect';\nconst client = new MongoClient('http://localhost:27017/post', {\n  useNewUrlParser: true,\n  useUnifiedTopology: true\n});\nexport async function setUpDb(db) {\n  await db.collection('posts'); //   .createIndex('expireAt', { expireAfterSeconds: 0 });\n}\nexport default async function database(req, res, next) {\n  if (!client.isConnected()) await client.connect();\n  req.dbClient = client;\n  req.db = client.db(process.env.DB_NAME);\n  await setUpDb(req.db);\n  return next();\n}","map":{"version":3,"sources":["/Users/StephenReiser/Desktop/SteveProject/next-sample/middleware/database.js"],"names":["MongoClient","nextConnect","client","useNewUrlParser","useUnifiedTopology","setUpDb","db","collection","database","req","res","next","isConnected","connect","dbClient","process","env","DB_NAME"],"mappings":"AAAA,SAASA,WAAT,QAA4B,SAA5B;AACA,OAAOC,WAAP,MAAwB,cAAxB;AAEA,MAAMC,MAAM,GAAG,IAAIF,WAAJ,CAAgB,6BAAhB,EAA+C;AAC5DG,EAAAA,eAAe,EAAE,IAD2C;AAE5DC,EAAAA,kBAAkB,EAAE;AAFwC,CAA/C,CAAf;AAKA,OAAO,eAAeC,OAAf,CAAuBC,EAAvB,EAA2B;AAC9B,QAAMA,EAAE,CACLC,UADG,CACQ,OADR,CAAN,CAD8B,CAG9B;AACD;AAED,eAAe,eAAeC,QAAf,CAAwBC,GAAxB,EAA6BC,GAA7B,EAAkCC,IAAlC,EAAwC;AACrD,MAAI,CAACT,MAAM,CAACU,WAAP,EAAL,EAA2B,MAAMV,MAAM,CAACW,OAAP,EAAN;AAC3BJ,EAAAA,GAAG,CAACK,QAAJ,GAAeZ,MAAf;AACAO,EAAAA,GAAG,CAACH,EAAJ,GAASJ,MAAM,CAACI,EAAP,CAAUS,OAAO,CAACC,GAAR,CAAYC,OAAtB,CAAT;AACA,QAAMZ,OAAO,CAACI,GAAG,CAACH,EAAL,CAAb;AACA,SAAOK,IAAI,EAAX;AACD","sourcesContent":["import { MongoClient } from 'mongodb';\nimport nextConnect from 'next-connect';\n\nconst client = new MongoClient('http://localhost:27017/post', {\n  useNewUrlParser: true,\n  useUnifiedTopology: true,\n});\n\nexport async function setUpDb(db) {\n    await db\n      .collection('posts')\n    //   .createIndex('expireAt', { expireAfterSeconds: 0 });\n  }\n  \n  export default async function database(req, res, next) {\n    if (!client.isConnected()) await client.connect();\n    req.dbClient = client;\n    req.db = client.db(process.env.DB_NAME);\n    await setUpDb(req.db);\n    return next();\n  }"]},"metadata":{},"sourceType":"module"}